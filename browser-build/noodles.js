/*@license
Noodles Templating Language, A high-performance, platform agnostic, templating system.
Copyright (C) 2012  Nathan Sweet

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
if(typeof process!="undefined")var define=require.define;define("../lib/number",["require","exports","module"],function(a,b,c){var d=b.Number=function(a,b){/^\-?\d+$/.test(b)?this.number=parseInt(b,10):/^\-?[^\d]*\d+[^1-9]*$/.test(b)?this.number=parseInt(b,10):/^\-?[\d]*\d+\.{1}\d+[^\d]/.test(b)?/^\-?0+$/.test(/\-?\d+\.{1}(\d)+/.exec(b)[1])?this.number=parseInt(b,10):this.number=parseFloat(b,10):this.number=parseInt(b,10)};d.prototype.execute=function(a,b){return this.number},d.prototype.type="number"});if(typeof process!="undefined")var define=require.define;define("../lib/string",["require","exports","module"],function(a,b,c){var d=b.String=function(a,b){this.string=b,this.length=b.length};d.prototype.execute=function(a,b){return this.string},d.prototype.type="string"});if(typeof process!="undefined")var define=require.define;define("../lib/config",["require","exports","module"],function(a,b,c){b.coretags=["iftag","settag","looptag","exittag"],b.languages=["english"]});if(typeof process!="undefined")var define=require.define;define("../lib/globalization",["require","exports","module","./config"],function(a,b,c){var d={},e={};b.language=function(b,c){typeof b!="string"&&(b="english"),b=b.toLowerCase();if(!d[this.language]){var g=this;b==="english"?(d[b]=!0,e[b]=new f(b,{}),c(e[b])):a(["./../globalization/"+b],function(a){d[b]=!0,e[b]=new f(b,language),c(e[b])})}else c(e[b])},b.addToLanguage=function(a,b){a=a.toString(),a=e[a];var c=Object.keys(b),d=c.length,f,g,h,i;while(d--!==0){i=b[c[d]],f=Object.keys(i),g=f.length,h=a[c[d]];while(g--!==0)h[f[g].toLowerCase()]=i[f[g]]}};var f=function(a,b){this.language=a;if(this.language!=="english"){var c=Object.keys(b),d=c.length;while(d--!==0)this[c[d]]=b[c[d]]}};f.prototype.warning=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.warnings[a.toLowerCase()]||a||"")+b.join("")},f.prototype.error=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.errors[a.toLowerCase()]||a||"")+b.join("")},f.prototype.tag=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.tags[a.toLowerCase()]||a||"")+b.join("")},f.prototype.other=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.others[a.toLowerCase()]||a||"")+b.join("")},f.prototype.plugin=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.plugin[a.toLowerCase()]||a||"")+b.join("")},f.prototype.coreTags=a("./config").coretags});if(typeof process!="undefined")var define=require.define;define("../lib/plugin",["require","exports","module","./globalization"],function(a,b,c){var d=a("./globalization"),e=["onTemplateCreate","willHandle","onTemplateExecute","handleToken","pluginName","browserFriendly"],f=b.Plugin=function(a){var b=e.length,c=this,d;try{while(b--){d=e[b];switch(d){case"willHandle":this.willHandle=a.willHandle;break;case"pluginName":this.pluginName=a.pluginName;break;case"browserFriendly":this.browserFriendly=a.browserFriendly;break;default:this["_"+d]=a[d]}}}catch(f){throw"All plugins must provide the member"+d+" even if it is empty."}};f.prototype.onTemplateCreate=function(b,c){var e=b.language.language.toLowerCase(),f;e==="english"?(this._onTemplateCreate(b),c()):a(["./../plugins/"+this.pluginName+"/"+this.pluginName+"_globalization."+e+(typeof process=="undefined"?".js":"")],function(a){f.languages=f.languages||{},f.languages[e]=a.languages,this.languages[e]&&d.addToLanguage(e,this.languages[e]),this._onTemplateCreate(b),c()})},f.prototype.onTemplateExecute=function(a,b){this._onTemplateExecute(a,b)},f.prototype.handleToken=function(a,b,c){return this._handleToken(a,b,c)}});if(typeof process!="undefined")var define=require.define,_Noodles=require("./../lib/noodles.js");define("../plugins/iftag/iftag_globalization.english.js",["require","exports","module"],function(a,b,c){b.language={}});if(typeof process!="undefined")var define=require.define,_Noodles=require("./../lib/noodles.js");define("../plugins/settag/settag_globalization.english.js",["require","exports","module"],function(a,b,c){b.language={}});if(typeof process!="undefined")var define=require.define,_Noodles=require("./../lib/noodles.js");define("../plugins/looptag/looptag_globalization.english.js",["require","exports","module"],function(a,b,c){b.language={}});if(typeof process!="undefined")var define=require.define,_Noodles=require("./../lib/noodles.js");define("../plugins/exittag/exittag_globalization.english.js",["require","exports","module"],function(a,b,c){b.language={}});if(typeof process!="undefined")var define=require.define;define("../lib/object",["require","exports","module","./string","./utilities"],function(a,b,c){var d=a("./string").String,e=a("./utilities"),f=b.Object=function(a,b){if(b.length===0){this.skip=!0;return}b=b.trim().toLowerCase(),this.needs={};var c=/([^\[\.]+)(\.|\[)?(.+)*/,h=/^('|")[^'"]+\1{1}$/,i=/^\d+$/,j=[],k=!1,l=!1,m=[],n=b,o,p,q;q=c.exec(n)[1],this.needs[q.toLowerCase()]=!0;do{o=c.exec(n),identifier=o[1],n=o[3];if(k){if(identifier.slice(-1)!=="]"){l=!0;break}identifier=identifier.slice(0,-1);if(!h.test(identifier)){if(g.test(identifier)){q=new f(a,identifier),this.needs=e.mergeObjectWith(this.needs,q.needs),j.push(q);continue}if(i.test(identifier)){j.push(parseInt(identifier,10));continue}l=!0;break}identifier=identifier.slice(1,-1)}if(!k&&!g.test(identifier)){l=!0;break}j.push(identifier.trim()),k=o[2]==="["}while(n);if(l===!0){e.warning(a,"Invalid object syntax"),this._skip=!0;return}this.order=j,this.olength=j.length,this.meta=!1,this.olength===1&&typeof j[0]=="string"&&typeof a._metaData!="undefined"&&typeof a._metaData[j[0]]!="undefined"&&(this.meta=!0,this.metaKey=j[0],this.needs=e.mergeObjectWith({},a._metaData[j[0]].needs)),q=e.stringOnly(this.order),q.stringOnly&&(this._stringOnly=!0,this.meta=!1,this.order=[new d(q.string)],this.olength=1,this.needs={})},g=f.reIdentifier=/[^\d\.\['"\s]{1}.*/;f.prototype.execute=function(a,b,c){if(!!this._stringOnly)return this.order[0].execute(a,b);try{return b.getObject(a,this.order,c)}catch(d){return b.debugMode&&b.error(a,"Was unable to get object "+this.modifies().join(".")),""}},f.prototype.set=function(a,b,c){if(!this.meta)try{c=typeof c.execute!="undefined"?c.execute(a,b):c,b.setObject(a,this.order,c)}catch(d){b.debugMode&&b.error(a,"Was unable to set object "+this.modifies().join("."))}else b.debugMode&&b.error(a,"Meta Data variable cannot be set at run time");return""},f.prototype.delete=function(a,b){if(!this.meta)try{b.deleteObject(a,this.order)}catch(c){b.debugMode&&b.error(a,"Was unable to delete object "+this.modifies().join("."))}else b.debugMode&&b.error(a,"Meta Data variable cannot be deleted at run time");return""},f.prototype.modifies=function(){if(typeof this._modifies!="undefined")return this._modifies;var a=this.order,b=0,c=a.length,d=[];while(b<c){if(typeof a[b]!="string"&&typeof a[b]!="number")break;d.push(a[b]),b++}return this._modifies=d,this._modifies},f.prototype.type="object"});if(typeof process!="undefined")var define=require.define;define("../lib/utilities",["require","exports","module","./string","./number","./object","./template","./template"],function(a,b,c){var d=a("./string").String,e=a("./number").Number,f=a("./object").Object,g=b.stringOnly=function(a){var b=a.length,c=!0,f="",g;while(b--){g=a[b];if(!(g instanceof d||!!g._stringOnly||g instanceof e)){c=!1;break}f=g.execute()+f}return{stringOnly:c,string:f}},h=b.warning=function(a,b){var c=i(a),d;if(typeof b=="string")a._warnings.push({warning:a.language.warning(b),lineNumber:c});else if(typeof b!="undefined"){d=b.length;while(d--)a._warnings.unshift({warning:a.language.warning(b),lineNumber:c})}},i=b.getLineCount=function(a){var b=a._leftCount,c=a._lineOffset,d=a._stringCache,e=-1,f=0,g=0;while(b>0)e=d.indexOf("<{",e+1),b--;while(e>f&&f>-1)f=d.indexOf("\n",f+1),g++;return(g>0?g:1)+c},j=b.mergeObjectWith=function(a,b){if(typeof a=="undefined"&&b==="undefined")return{};if(typeof a=="undefined")return b;if(typeof b=="undefined")return a;var c=Object.keys(b),d=c.length;while(d--)a[c[d]]=b[c[d]];return a},k=b.mergeWarnings=function(a,b){typeof b._warnings!="undefined"&&b._warnings.length!==0&&(typeof a._warnings=="undefined"&&(a._warnings=[]),a._warnings=a._warnings.concat(b._warnings.slice()),a._warnings.sort(function(a,b){return a.lineNumber-b.lineNumber}))},l=b.createSubTemplate=function(b,c,d){typeof _Template=="undefined"&&(_Template=a("./template").Template);var e=i(b),f=new _Template({rawString:c,lineOffset:e},b);return k(b,f),b._leftCount=b._leftCount+f._leftCount,typeof d!="undefined"&&(d.needs=j(d.needs,f.needs),d.sets=j(d.sets,f.sets),d.modifies=j(d.modifies,f.modifies),d.needsCallback=!!f.needsCallback),f},m=b.parseType=function(b,c){return typeof _Template=="undefined"&&(_Template=a("./template").Template),c=c.trim(),b instanceof _Template||h(b,"parseType expects its first argument to be a Noodles Template"),/^\-?\d+\.?\d*$/.test(c)?new e(b,c):/^('|")[^'"]+\1{1}$/.test(c)?new d(b,c.slice(1,-1)):f.reIdentifier.test(c)?new f(b,c):c},n=b.grabToEndSliceRaw=function(a,b,c){if(typeof a.endTags=="undefined")return"";var d=a._rawString,e=Object.keys(a.endTags),f=0,g=[],i=/<\{end(\s|\}){1}/i,j=e.length,k=1,l,m;while(j--)g.push(new RegExp("<\\{"+e[j]+"\\s{1}","i"));while(k>0){l=o(d,g,f),m=o(d,i,f);if(m>l&&l!==-1)k++,f=l+1,l=0;else if(m!==-1)k--,f=m+1;else if(k!==-1){c=c||"Tag",h(a,c+a.language.warning(" was improperly ended")),typeof b!="undefined"&&(b.skip=!0);break}}return f--,k=d.indexOf("}>",f),a._rawString=a._rawString.slice(k+2),d.slice(0,f)},o=b.searchByIndex=function(a,b,c){a=a.slice(c),typeof c=="undefined"&&(c=0);var d=-1,e,f;typeof b.length=="undefined"&&(b=[b]),e=b.length;while(e--)f=a.search(b[e]),f!==-1&&(f<d||d===-1)&&(d=f);return d===-1?-1:d+c}});if(typeof process!="undefined")var define=require.define;define("../lib/context",["require","exports","module","./template"],function(a,b,c){var d,e=b.Context=function(b,c,e){typeof d=="undefined"&&(d=a("./template").Template),this._others=c,this._metaData=b._metaData,this._metaSkip={},this.exitNow=!1,this.exitLoop=!1,e?(this.debugMode=!0,this.errors=[]):this.debugMode=!1};e.prototype.getObject=function(a,b,c){b=typeof b!="object"?[b]:b;var d=b[0].toLowerCase(),e,f,g;if(!this._metaSkip[d]&&this._metaData.hasOwnProperty(d))return this._metaData[d].execute(a,this);e=this._others;for(var h=0,i=b.length;h<i;h++){d=typeof b[h].execute!="undefined"?b[h].execute(a,this).toLowerCase():b[h];if(typeof e[d]!="undefined")e=e[d];else{f=","+Object.keys(e).join()+",",g=f.toLowerCase().indexOf(","+d+",");if(!(g>-1))return e[d]="","";d=f.slice(keyindex+1,keyindex+1+d.length),e[d.toLowerCase()]=e[d],e=e[d]}}return typeof e.execute!="undefined"?e.execute(a,this):typeof e=="object"&&!c?" ":e},e.prototype.setObject=function(a,b,c){b=typeof b!="object"?[b]:b;var d=this._others,e=b[0].toLowerCase(),d,f,g;!this._metaSkip[e]&&this._metaData.hasOwnProperty(e)&&this.debugMode&&this.error(a,"Meta Data variable cannot be set at run time");for(var h=0,i=b.length-1;h<i;h++){e=typeof b[h].execute!="undefined"?b[0].execute(a,this).toLowerCase():b[h];if(typeof d[e]!="undefined")d=d[e];else{f=","+Object.keys(d).join()+",",g=f.toLowerCase().indexOf(","+tmp+",");if(!(g>-1))return"";e=f.slice(keyindex+1,keyindex+1+e.length),d[e.toLowerCase()]=d[e],d=d[e]}}d[(typeof b[i].execute!="undefined"?b[i].execute(a,this):b[i]).toLowerCase()]=typeof c.execute!="undefined"?c.execute(a,this):c},e.prototype.deleteObject=function(a,b){b=typeof b!="object"?[b]:b;var c=this._others,d=b[0].toLowerCase(),c,e,f;this._metaData.hasOwnProperty(d)&&this.debugMode&&this.error(a,"Meta Data variable cannot be deleted at run time");for(var g=0,h=b.length-1;g<h;g++){d=typeof b[g].execute!="undefined"?b[g].execute(a,this).toLowerCase():b[g];if(typeof c[d]!="undefined")c=c[d];else{e=","+Object.keys(c).join()+",",f=e.toLowerCase().indexOf(","+tmp+",");if(!(f>-1))return"";d=e.slice(keyindex+1,keyindex+1+d.length),c[d.toLowerCase()]=c[d],c=c[d]}}delete c[(typeof b[h].execute!="undefined"?b[h].execute(a,this):b[h]).toLowerCase()]},e.prototype.error=function(a,b){var c=a._executionStack[e.current].lineStart;this.errors.push({error:a.language.error(b+"on line "+c+"."),lineNumber:c})}});if(typeof process!="undefined")var define=requirejs.define;define("../lib/template",["require","exports","module","./utilities","./string","./object","./context","./globalization"],function(a,b,c){var d=a("./utilities"),e=a("./string").String,f=a("./object").Object,g=a("./context").Context,h=a("./globalization"),i=typeof process=="undefined",j={},k=b.Template=function(a,b){this._rawString=a.rawString,this._stringCache=a.rawString,this._document=[],this._leftCount=0,this._warnings=[],this._metaData={},this._needs={},this._master=!1,this._tagDelegation={},this._lineOffset=a.lineOffset||0,this._executeOnce=!!a.executeOnce,a.metaKey&&(this._metaKey=a._metaKey);var c=a.metaData,d;typeof a.metaData!="undefined"?l.call(this,a):typeof b!="undefined"&&b instanceof k&&(this._plugins=b._plugins,this.language=b.language,u.call(this))},l=function(a){var b=this;this._id="master-"+Date.now(),a.language=typeof a.language!="undefined"?a.language:"english",h.language(a.language,function(c){m.call(b,a,c)})},m=function(a,b){this.language=b,this._plugins=this.language.coreTags.slice();var c=a.metaData,d=c.split(/\n+/),e=d.length,g=/([^=]+)(={1})(.*)/,h,i,j,l,m;if(c.length>0)while(e--){if(/^\s+$/.test(d[e]))continue;h=g.exec(d[e].trim()),i=h[1].toLowerCase().trim(),j=h[3].trim();if(f.reIdentifier.test(i)&&h[2]==="="){if(i===this.language.other("plugins")){this._plugins=this._plugins.concat(j.toLowerCase().split(","));continue}switch(i[0]){case"\\":this._metaData[i.slice(1)]=new k({rawString:j,executeOnce:!0,metaKey:i.slice(1)},this);break;case"#":break;default:this._metaData[i]=new k({rawString:j,executeOnce:!1},this)}}}this._master=!0,this.onFinishCompiling=a.onFinishCompiling,u.call(this)},n=function(){this._templating=!0;while(this._templating)o.call(this);this._master&&(this.onFinishCompiling(this),delete this.onFinishedCompiling)},o=function(){var a=this._rawString.indexOf("<{"),b=this._rawString.indexOf("}>"),c,f,g,h;if(a>-1){this._leftCount++;if(b>-1){c=this._rawString.slice(a+2,b),this._document.push(new e(this,this._rawString.slice(0,a))),this._rawString=this._rawString.slice(b+2);if(c.charAt(0)===" ")d.warning(this,"Invalid whitespace at the start of expression");else{f=c.split(" ")[0].toLowerCase(),g=d.getLineCount(this),h=f.split(".")[0],c=typeof j[this._tagDelegation[h]]!="undefined"?j[this._tagDelegation[h]].handleToken(this,c,f):d.parseType(this,c);if(typeof c.skip=="undefined"||c.skip===!1)c.lineStart=g,this._document.push(c),c.needs=c.needs||{}}}else this._rawString=this._rawString.slice(a+2),d.warning(this,"Open ended expression")}else this._rawString.length>0&&this._document.push(new e(this,this._rawString)),this._documentLength=this._document.length,delete this._rawString,f=d.stringOnly(this._document),f.stringOnly&&(this._stringOnly=!0,this._document=[new e(this,f.string)],this._documentLength=1,this.needs={}),this._templating=!1,p.call(this,this._master)},p=function(a){r.call(this,a),this._executionOrders=[],this._inAlready={};var b=this.callBackDocs.length,c,d;while(b--){if(this._inAlready[c.toString()])continue;this._executionOrders.unshift([]),c=this.callBackDocs[b],this._inAlready[c.toString()]=!0,q.call(this,c),this._executionOrders[0].push(c)}this._executionOrders.push([]),d=this._executionStack.length,b=0;while(b<d){if(this._inAlready[b.toString])continue;this._inAlready[b.toString()]=!0,q.call(this,b),this._executionOrders[0].push(b),b++}this._executionThreadLength=this._executionOrders.length},q=function(a){var b=this._executionStack[a],c=a+1,d,e,f;while(c--){if(this._inAlready[c.toString()])continue;d=this._executionStack[c];if(d.isAmbiguous){typeof d.needs!="undefined"&&Object.keys(d.needs).length!==0&&q.call(this,c),this._executionOrders[0].unshift(c),this._inAlready[c.toString()]=!0;continue}f=[],typeof d.modifies!="undefined"&&(f=f.concat(Object.keys(d.modifies))),typeof d.sets!="undefined"&&(f=f.concat(Object.keys(d.sets))),e=f.length;while(e--)if(typeof b.needs!="undefined"&&b.needs[f[e]]){typeof d.needs!="undefined"&&Object.keys(d.needs).length!==0&&q.call(this,c),this._executionOrders[0].unshift(c),this._inAlready[c.toString()]=!0;break}}return a},r=function(a){this.needs={},this.sets={},this.modifies={},this.callBackDocs=[];var b=this._document,c=b.length,d=0,f=[],g=-1,h,i,j,k,l,m;while(d<c){h=b[d];if(h.skip){d++;continue}if(h instanceof e&&h.string.length===0){d++;continue}g++,f.push(h),h.isAmbiguous?this.isAmbiguous=!0:h.needsCallback&&(this.needsCallback=!0,this.callBackDocs.push(g));if(typeof h.sets!="undefined"){j=Object.keys(h.sets),l=j.length;while(l--)m=j[l].toLowerCase(),typeof this.sets[m]=="undefined"?this.sets[m]=!0:delete h.sets[j[l]]}if(typeof h.needs!="undefined"){i=Object.keys(h.needs),l=i.length;while(l--)m=i[l].toLowerCase(),typeof this.sets[m]=="undefined"&&(this.needs[m]=!0)}if(typeof h.modifies!="undefined"){k=Object.keys(h.modifies),l=k.length;while(l--)m=k[l].toLowerCase(),this.modifies[m]=!0}d++}this._executionStack=f,this._executionLength=this._executionStack.length};k.prototype.execute=function(a,b,c,d){var e,f,h=Date.now(),i,l;if(a instanceof k)e=b;else{e=new g(this,a,!!d),e.time=h,e.onRender=typeof b.onRender=="undefined"||b.debugMode?!1:b.onRender,e.onRenderAll=typeof b.onRenderAll=="undefined"?!1:b.onRenderAll,e.onFinish=typeof b.onFinish=="undefined"?function(){}:b.onFinish,e.bufferMode=!!c,i=this._plugins,l=i.length;while(l--)j[i[l]].onTemplateExecute(e,this)}f={},f.collected=new Array(this._executionLength),f.status=new Array(this._executionLength),f.threads=new Array(this._executionThreadLength),f.startFrom=0;if(this._master)s.call(this,e,!0,f,!1);else{if(!this.needsCallback)return s.call(this,e,!0,f);s.call(this,e,!0,f,c)}};var s=function(a,b,c,d){var e=0,f=b?this._executionOrders:c.threads[e],g=f.length,h=!1,i=this,j=[],k=this._master&&a.bufferMode,l=!1;while(e<g&&!a.exitNow)c.threads[e]=f[e].reduce(function(b,e){if(h||a.exitNow)return b.concat(e);if(typeof c.status[e]=="undefined")return i._executionStack[e].needsCallback?(c.status[e]="executing",a.debugMode&&(a._current=e),i._executionStack[e].execute(i,a,function(b){c.collected[e]=b,c.status[e]="done",s.call(i,a,!1,c,d)}),h=!0,b):(a.debugMode&&(a._current=e),c.collected[e]=i._executionStack[e].execute(i,a),c.status[e]="done",b);if(c.status[e]==="executing")return h=!0,b;if(c.status[e]==="done")return b},[]),c.threads[e].length===0&&(c.threads.splice(e,1),g--),h=!1,e++;return t.call(this,a,c,d,j)},t=function(a,b,c,d){var e=this._master&&a.bufferMode,f,g;if(a.onRender&&this._master){f=b.startFrom,g=this._executionLength;while(f<g){if(typeof b.status[f]=="undefined")break;if(b.status[f]!=="done")break;d.push(b.collected[f]),f++}d=e&&this._master?new Buffer(d.join("")):d.join(""),this._master&&a.onRender(d,a),b.startFrom=f}if(b.threads.length===0||a.exitNow){d=e&&this._master?new Buffer(b.collected.join("")):b.collected.join("");if(this._master)a.onRenderAll&&a.onRenderAll(d,a),a.onFinish(Date.now()-a.time,a);else{if(typeof c!="function")return this._executeOnce&&(a._metaSkip[this._metaKey]=!0,a.setObject(this,this._metaKey,d)),d;c(d)}}},u=function(){var a=this._plugins.length,b=a,c=this,e,f,g,h;console.log();while(a--)e=this.language.plugin(this._plugins[a]),typeof j[e]!="undefined"?(h=j[e],i&&!h.browserFriendly&&d.warning(this,["The following plugin will not work for the browser: ",c.language.others(h.pluginName)]),typeof h.onTemplateCreate!="undefined"&&h.onTemplateCreate(this,function(){b--;if(typeof h.willHandle!="undefined"&&h.handleToken!=="undefined"){var a=h.willHandle(c),d=a.length;while(d--)c._tagDelegation[a[d]]=h.pluginName;b===0&&(b=-1,n.call(c))}})):v.call(this,e,function(){b--,b===0&&(b=-1,n.call(c))})},v=function(b,c,e){var f=e?"./../../noodles_plugins/"+b+"/"+b:"./../plugins/"+b+"/"+b,g=this;a([f],function(a){if(typeof a=="undefined"||typeof a.Plugin=="undefined"){if(e)throw b+" does not exist as a plugin.";return v.call(g,b,c,!0)}a=a.Plugin;if(typeof a.pluginName=="undefined")throw"The following plugin needs a plugin name: "+a.toString();i&&!a.browserFriendly&&d.warning(g,["The following plugin will not work for the browser: ",g.language.others(a.pluginName)]),typeof a.onTemplateCreate!="undefined"&&a.onTemplateCreate(g,function(){c(),j[a.pluginName]=a;if(typeof a.willHandle!="undefined"&&a.handleToken!=="undefined"){var b=a.willHandle(g),d=b.length;while(d--)g._tagDelegation[b[d]]=a.pluginName}})})}});if(typeof process!="undefined"){var define=require("requirejs");define.config({baseUrl:__dirname,nodeRequire:require})}define("../lib/noodles.js",["./template","./number","./string","./plugin","./utilities","./object","./context","./config"],function(a,b,c,d,e,f,g,h){if(typeof process=="undefined")return{Template:a.Template,Number:b.Number,String:c.String,Plugin:d.Plugin,Object:f.Object,Context:g.Context,Utilities:e,Config:h};exports.Template=a.Template,exports.Number=b.Number,exports.String=c.String,exports.Plugin=d.Plugin,exports.Object=f.Object,exports.Context=g.Context,exports.Utilities=e,exports.Config=h});if(typeof process!="undefined")var define=require.define;define("../plugins/iftag/iftag.js",["require","exports","module","./../../lib/noodles.js"],function(a,b,c){var d=a("./../../lib/noodles.js");b.Plugin=new d.Plugin({willHandle:function(a){return[a.language.tag("if")]},pluginName:"iftag",browserFriendly:!0,onTemplateCreate:function(a){a.endTags=a.endTags||{},a.endTags[a.language.tag("if")]=!0},onTemplateExecute:function(a,b){},handleToken:function(a,b,c){switch(c){case a.language.tag("if"):return new e(a,b);default:return{skip:!0}}}});var e=function(a,b){this.rawString=d.Utilities.grabToEndSliceRaw(a,b,a.language.tag("If")),this.needs={},this.conditions=[{condition:f.call(this,a,b,!0)}],_parseConditional.call(this,a)};_parseConditional=function(a){var b=new RegExp("<\\{"+a.language.tag("else")+"(\\s*|\\}|"+a.language.tag("if")+"\\s+)","i"),c=this.rawString,e=Object.keys(a.endTags),g=0,h=[],i=new RegExp("<\\{"+a.language.tag("end")+"(\\s|\\}){1}","i"),j=[new RegExp("<\\{"+a.language.tag("if")+"\\s+","i")],k=0,l=[],m=e.length,n,o,p,q,r;p=d.Utilities.searchByIndex(c,b,g);if(p!==-1){while(m--){if(e[m].toLowerCase()===a.language.tag("if"))continue;h.push(new RegExp("<\\{"+e[m]+"\\s{1}","i"))}while(p!==-1){n=d.Utilities.searchByIndex(c,h,g),o=d.Utilities.searchByIndex(c,i,g),q=d.Utilities.searchByIndex(c,j,g);if(q!==-1&&q<o&&(q<p||p===-1)&&(q<=n||n===-1))k++,l.push("if"),g=q+1,q=0;else if(n!==-1&&n<o)l.push("unknown"),g=n+1,n=0;else if(o!==-1)r=l.pop(),g=o+1,r==="if"&&k--;else if(n!==-1){this.skip=!0,d.Utilities.warning(a,"If tag not ended properly");break}k===0&&p!==-1&&p>=g&&(r=this.conditions.length-1,this.conditions[r].rawString=c.slice(0,p),this.conditions[r].template=d.Utilities.createSubTemplate(a,this.conditions[r].rawString,this),a._leftCount++,r=c.indexOf("}>",p),this.conditions.push({condition:f.call(this,a,c.slice(p+2,r))}),c=c.slice(r+2),g=0),p=d.Utilities.searchByIndex(c,b,g)}}r=this.conditions.length-1,this.conditions[r].rawString=c,this.conditions[r].template=d.Utilities.createSubTemplate(a,this.conditions[r].rawString,this),a._leftCount++};var f=e.parseConditions=function(a,b,c){var e=/(?:\s*)(!?)([^<>=!\s]+)(?:\s*)(==|!=|<|>|<=|>=)?(?:\s*)(!?)([^<>=!\s]*)(?:\s*)/,f=[],h=[],i=new RegExp("\\s+"+a.language.tag("and")+"\\s+","i"),j,k;if((new RegExp(a.language.tag("else")+"(\\s+\\.*|)$","i")).test(b))return"else";if(!(new RegExp(a.language.tag("elseif")+"s+","i")).test(b)&&!c)return d.Utilities.warning(a,"Else statement expected"),!1;b=c?/if\s+(.+)/i.exec(b)[1]:(new RegExp(a.language.tag("elseif")+"\\s+(.+)","i")).exec(b)[1],b=b.split(new RegExp("\\s+"+a.language.other("or")+"\\s+","i"));for(var l=0,m=b.length;l<m;l++){j=b[l].split(i),h=[];for(var n=0,o=j.length;n<o;n++)k=e.exec(j[n]),h.push(new g(k,this,a));f.push(h.slice())}return f};e.prototype.execute=function(a,b,c){var d=0,e=this.conditions.length,f;while(d<e){if(this.conditions[d].condition==="else")return this.conditions[d].template.execute(a,b,c);f=this.conditions[d].condition.reduce(function(c,d){return c?!0:d.reduce(function(c,d){return c?d.execute(a,b):!1},!0)},!1);if(f){if(this.needsCallback){this.conditions[d].template.needsCallback?this.conditions[d].template.execute(a,b,c):c(this.conditions[d].template.execute(a,b));break}return this.conditions[d].template.execute(a,b)}d++}};var g=function(a,b,c){this.leftSide=d.Utilities.parseType(c,a[2]),b.needs=d.Utilities.mergeObjectWith(b.needs,this.leftSide.needs),this.leftNegate=a[1].length>0,this.super=!1;if(typeof a[3]!="undefined"&&a[5].length>0){switch(a[3]){case c.language.other("contains"):this.expression="contains";break;case c.language.other("startswith"):this.expression="startswith";break;case c.language.other("endswith"):this.expression="endswith";break;case c.language.other("matches"):this.expression="matches";default:this.expression=a[3].toLowerCase()}this.rightSide=d.Utilities.parseType(c,a[5]),this.rightNegate=a[4].length>0,b.needs=d.Utilities.mergeObjectWith(b.needs,this.rightSide.needs)}else this.expression=!1};g.prototype.execute=function(a,b){var c=this.leftNegate?!this.leftSide.execute(a,b):this.leftSide.execute(a,b),d;c=typeof c=="string"?c.toLowerCase():c;if(!this.expression)return!!c;d=this.rightNegate?!this.rightSide.execute(a,b):this.rightSide.execute(a,b),d=typeof d=="string"?d.toLowerCase():d;switch(this.expression){case"==":return c==d;case"!=":return c!=d;case"<":return c<d;case">":return c>d;case"<=":return c<=d;case">=":return c>=d;case"contains":return typeof c=="string"&&typeof d=="string"?c.indexOf(d)>-1:!1;case"startswith":return typeof c=="string"&&typeof d=="string"?(new RegExp("^"+d)).test(c):!1;case"endswith":return typeof c=="string"&&typeof d=="string"?(new RegExp(d+"$")).test(c):!1;case"matches":return typeof c=="string"&&d.constructor.name==="RegExp"?d.test(c):typeof d=="string"?(new RegExp(d)).test(c):!1;default:return!1}}});if(typeof process!="undefined")var define=require.define;define("../plugins/settag/settag.js",["require","exports","module","./../../lib/noodles.js"],function(a,b,c){var d=a("./../../lib/noodles.js");b.Plugin=new d.Plugin({willHandle:function(a){return[a.language.tag("set"),a.language.tag("setalist"),a.language.tag("setahash"),a.language.tag("addtolist"),a.language.tag("setaregex")]},pluginName:"settag",browserFriendly:!0,onTemplateCreate:function(a,b){},onTemplateExecute:function(a,b){},handleToken:function(a,b,c){switch(c){case a.language.tag("set"):return new e(a,b);case a.language.tag("setalist"):return new f(a,b);case a.language.tag("setahash"):return new g(a,b);case a.language.tag("addtolist"):return new h(a,b);case a.language.tag("setaregex"):return new i(a,b);default:return{skip:!0}}}});var e=function(a,b){this.needs={},b=b.split(" ");if(b.length<4){this.skip=!0,d.Utilities.warning(a,"Set tag has bad syntax");return}var c=d.Utilities.parseType(a,b[1]);if(c.type!=="object"){this.skip=!0,d.Utilities.warning(a,"Set tag has bad syntax, the variable must be an identifier or object");return}this.key=c,this.key.order.length>1?this.needs=d.Utilities.mergeObjectWith(this.needs,this.key.needs):(this.sets={},this.sets[this.key.order[0]]=!0),this.modifies={},this.modifies[this.key.order[0]]=!0,this.value=d.Utilities.parseType(a,b[3]),this.needs=d.Utilities.mergeObjectWith(this.needs,this.value.needs)};e.prototype.execute=function(a,b){return this.key.set(a,b,this.value),""};var f=function(a,b){this.needs={};var c=new RegExp("^"+a.language.tag("setalist")+"\\s+([^=]+)\\s*=\\s*(.+)"),e,f,g;if(!c.test(b)){this.skip=!0,d.Utilities.warning(a,"Setalist tag has bad syntax");return}b=c.exec(b),e=d.Utilities.parseType(a,b[1]);if(e.type!=="object"){this.skip=!0,d.Utilities.warning(a,"Setalist tag has bad syntax, the variable must be an identifier or object");return}this.key=e,this.key.order.length>1?this.needs=d.Utilities.mergeObjectWith(this.needs,this.key.needs):(this.sets={},this.sets[this.key.order[0]]=!0),this.modifies={},this.modifies[this.key.order[0]]=!0,f=b[2].split(",");for(var h=0,i=f.length;h<i;h++)f[h]=d.Utilities.parseType(a,f[h].trim()),this.needs=d.Utilities.mergeObjectWith(this.needs,f[h].needs);this.value=f};f.prototype.execute=function(a,b){return this.key.set(a,b,this.value),""};var g=function(a,b){this.needs={};var c=new RegExp("^"+a.language.tag("setahash")+"\\s+([^=]+)\\s*=\\s*(.+)"),e={},f,g,h;if(!c.test(b)){this.skip=!0,d.Utilities.warning(a,"Setahash tag has bad syntax");return}b=c.exec(b),f=d.Utilities.parseType(a,b[1]);if(f.type!=="object"){this.skip=!0,d.Utilities.warning(a,"Setahash tag has bad syntax, the variable must be an identifier or object");return}this.key=f,this.key.order.length>1?this.needs=d.Utilities.mergeObjectWith(this.needs,this.key.needs):(this.sets={},this.sets[this.key.order[0]]=!0),this.modifies={},this.modifies[this.key.order[0]]=!0,g=b[2].split(",");for(var i=0,j=g.length;i<j;i++)g[i]=g[i].split(":"),h=g[i][0].trim().toLowerCase(),e[h]=d.Utilities.parseType(a,g[i][1].trim()),this.needs=d.Utilities.mergeObjectWith(this.needs,e[h].needs);this.value=e};g.prototype.execute=function(a,b){return this.key.set(a,b,this.value),""};var h=function(a,b){this.needs={};var c=new RegExp("^"+a.language.tag("addtolist")+"\\s+([^=]+)\\s+to\\s+(.+)");if(!c.test(b)){this.skip=!0,d.Utilities.warning(a,"Addtolist tag has bad syntax");return}b=c.exec(b),this.value=d.Utilities.parseType(a,b[1]),this.list=d.Utilities.parseType(a,b[2]);if(this.list.type!=="object"){this.skip=!0,d.Utilities.warning(a,"Addtolist tag has bad syntax, the list must be an identifier or object");return}this.needs=d.Utilities.mergeObjectWith(this.needs,this.value.needs),this.needs=d.Utilities.mergeObjectWith(this.needs,this.list.needs),this.modifies={},this.modifies[this.list.order[0]]=!0};h.prototype.execute=function(a,b){var c=this.list.execute(a,b,!0);return c.push(this.value.execute(a,b)),""};var i=function(a,b){this.needs={},b=b.split(/\s+/),this.name=d.Utilities.parseType(a,b[0]);if(this.name.type!=="object"){d.Utilities.warning(a,"SetARegEx tag has bad syntax, the name must be an identifier"),this.skip=!0;return}this.value=d.Utilities.parseType(a,b[2]),this.options=typeof b[3]=="string"&&b[3].length>0?b[3].toLowerCase():!1;if(this.value.type==="string")this.regex=this.options?new RegExp(this.value.execute(),this.options):new RegExp(this.value.execute());else{if(this.value.type!=="object"){this.skip=!0,d.Utilities.warning(a,"SetARegEx tag has bad syntax, the value must receive a string or object");return}this.regex=!1,this.needs=d.Utilities.mergeObjectWith(this.needs,this.value.needs),this.modifies={},this.modifies[this.value.order[0]]=!0}};i.prototype.execute=function(a,b){var c=this.regex===!1?this.options?new RegExp(this.value.execute(a,b),this.options):new RegExp(this.value.execute(a,b)):this.regex;return this.name.set(a,b,c),""}});if(typeof process!="undefined")var define=require.define;define("../plugins/looptag/looptag.js",["require","exports","module","./../../lib/noodles.js"],function(a,b,c){var d=a("./../../lib/noodles.js");b.Plugin=new d.Plugin({willHandle:function(a){return[a.language.tag("loop")]},pluginName:"looptag",browserFriendly:!0,onTemplateExecute:function(a,b){},onTemplateCreate:function(a){a.endTags=a.endTags||{},a.endTags[a.language.tag("loop")]=!0},handleToken:function(a,b,c){switch(c){case a.language.tag("loop"):return new e(a,b);default:return{skip:!0}}}});var e=function(a,b){var c,e,f;this.rawString=d.Utilities.grabToEndSliceRaw(a,b,a.language.tag("Loop")),this.needs={},b=b.split(" ");if(b.length<2){this.skip=!0,d.Utilities.warning(a,"Loop tag has bad syntax");return}this.object=d.Utilities.parseType(a,b[1]);if(!(this.object instanceof d.Object)){this.skip=!0,d.Utilities.warning(a,"Loop must have an object to loop over"),delete this.object;return}this.needs=d.Utilities.mergeObjectWith(this.needs,this.object.needs),this.template=d.Utilities.createSubTemplate(a,this.rawString,this),a._leftCount++,this.sets={},this.modifies={},c=a.language.other("name"),this.name=new d.Object(this.template,c),this.sets[c],this.modifies[c],value=a.language.other("value"),this.value=new d.Object(this.template,value),f="__"+a.language.other("index"),this.index=new d.Object(this.template,f),this.sets[f],this.modifies[f],this.setExists=!1;if(b.length>=4){this.setObject=new d.Object(this.template,b[3]);if(this.setObject.key.order.length>1){d.Utilities.warning(a,"Loop cannot set an object with multiple levels"),this.skip=!0,delete this.setObjet;return}this.setExists=!0}};e.prototype.execute=function(a,b,c){var d=this.object.execute(a,b,!0),e=d!==""?Object.keys(d):"",f=e.length,g=0,h=[],i;if(e==="")return"";while(g<f&&!b.exitLoop)i=e[g],this.name.set(a,b,i),this.value.set(a,b,d[i]),this.index.set(a,b,g),this.setExists&&this.setObject.set(a,b,d[i]),h.push(this.template.execute(a,b)),g++;return b.exitLoop=!1,b.exitNow=!1,this.name.delete(a,b),this.value.delete(a,b),this.index.delete(a,b),this.setExists&&this.setObject.delete(a,b),h.join("")}});if(typeof process!="undefined")var define=require.define;define("../plugins/exittag/exittag.js",["require","exports","module","./../../lib/noodles.js"],function(a,b,c){var d=a("./../../lib/noodles.js");b.Plugin=new d.Plugin({willHandle:function(a){return[a.language.tag("exit"),a.language.tag("exitloop")]},pluginName:"exittag",browserFriendly:!0,onTemplateCreate:function(a,b){},onTemplateExecute:function(a,b){},handleToken:function(a,b,c){switch(c){case a.language.tag("exit"):return new e(a,b);case a.language.tag("exitloop"):return new e(a,b,!0);default:return{skip:!0}}}});var e=function(a,b,c){this.loop=!!c,this.needs={},this.isAmbiguous=!0,this.modifies={}};e.prototype.execute=function(a,b,c){b.exitNow=!0,this.loop&&(b.exitLoop=!0)}});if(typeof process!="undefined")var define=require.define;define("number",["require","exports","module"],function(a,b,c){var d=b.Number=function(a,b){/^\-?\d+$/.test(b)?this.number=parseInt(b,10):/^\-?[^\d]*\d+[^1-9]*$/.test(b)?this.number=parseInt(b,10):/^\-?[\d]*\d+\.{1}\d+[^\d]/.test(b)?/^\-?0+$/.test(/\-?\d+\.{1}(\d)+/.exec(b)[1])?this.number=parseInt(b,10):this.number=parseFloat(b,10):this.number=parseInt(b,10)};d.prototype.execute=function(a,b){return this.number},d.prototype.type="number"});if(typeof process!="undefined")var define=require.define;define("string",["require","exports","module"],function(a,b,c){var d=b.String=function(a,b){this.string=b,this.length=b.length};d.prototype.execute=function(a,b){return this.string},d.prototype.type="string"});if(typeof process!="undefined")var define=require.define;define("config",["require","exports","module"],function(a,b,c){b.coretags=["iftag","settag","looptag","exittag"],b.languages=["english"]});if(typeof process!="undefined")var define=require.define;define("globalization",["require","exports","module","./config"],function(a,b,c){var d={},e={};b.language=function(b,c){typeof b!="string"&&(b="english"),b=b.toLowerCase();if(!d[this.language]){var g=this;b==="english"?(d[b]=!0,e[b]=new f(b,{}),c(e[b])):a(["./../globalization/"+b],function(a){d[b]=!0,e[b]=new f(b,language),c(e[b])})}else c(e[b])},b.addToLanguage=function(a,b){a=a.toString(),a=e[a];var c=Object.keys(b),d=c.length,f,g,h,i;while(d--!==0){i=b[c[d]],f=Object.keys(i),g=f.length,h=a[c[d]];while(g--!==0)h[f[g].toLowerCase()]=i[f[g]]}};var f=function(a,b){this.language=a;if(this.language!=="english"){var c=Object.keys(b),d=c.length;while(d--!==0)this[c[d]]=b[c[d]]}};f.prototype.warning=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.warnings[a.toLowerCase()]||a||"")+b.join("")},f.prototype.error=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.errors[a.toLowerCase()]||a||"")+b.join("")},f.prototype.tag=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.tags[a.toLowerCase()]||a||"")+b.join("")},f.prototype.other=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.others[a.toLowerCase()]||a||"")+b.join("")},f.prototype.plugin=function(a){if(typeof a!="string")return"";if(this.language==="english")return a;var b=Array.prototype.slice.call(arguments);return b.shift(),(this.plugin[a.toLowerCase()]||a||"")+b.join("")},f.prototype.coreTags=a("./config").coretags});if(typeof process!="undefined")var define=require.define;define("plugin",["require","exports","module","./globalization"],function(a,b,c){var d=a("./globalization"),e=["onTemplateCreate","willHandle","onTemplateExecute","handleToken","pluginName","browserFriendly"],f=b.Plugin=function(a){var b=e.length,c=this,d;try{while(b--){d=e[b];switch(d){case"willHandle":this.willHandle=a.willHandle;break;case"pluginName":this.pluginName=a.pluginName;break;case"browserFriendly":this.browserFriendly=a.browserFriendly;break;default:this["_"+d]=a[d]}}}catch(f){throw"All plugins must provide the member"+d+" even if it is empty."}};f.prototype.onTemplateCreate=function(b,c){var e=b.language.language.toLowerCase(),f;e==="english"?(this._onTemplateCreate(b),c()):a(["./../plugins/"+this.pluginName+"/"+this.pluginName+"_globalization."+e+(typeof process=="undefined"?".js":"")],function(a){f.languages=f.languages||{},f.languages[e]=a.languages,this.languages[e]&&d.addToLanguage(e,this.languages[e]),this._onTemplateCreate(b),c()})},f.prototype.onTemplateExecute=function(a,b){this._onTemplateExecute(a,b)},f.prototype.handleToken=function(a,b,c){return this._handleToken(a,b,c)}});if(typeof process!="undefined")var define=require.define;define("object",["require","exports","module","./string","./utilities"],function(a,b,c){var d=a("./string").String,e=a("./utilities"),f=b.Object=function(a,b){if(b.length===0){this.skip=!0;return}b=b.trim().toLowerCase(),this.needs={};var c=/([^\[\.]+)(\.|\[)?(.+)*/,h=/^('|")[^'"]+\1{1}$/,i=/^\d+$/,j=[],k=!1,l=!1,m=[],n=b,o,p,q;q=c.exec(n)[1],this.needs[q.toLowerCase()]=!0;do{o=c.exec(n),identifier=o[1],n=o[3];if(k){if(identifier.slice(-1)!=="]"){l=!0;break}identifier=identifier.slice(0,-1);if(!h.test(identifier)){if(g.test(identifier)){q=new f(a,identifier),this.needs=e.mergeObjectWith(this.needs,q.needs),j.push(q);continue}if(i.test(identifier)){j.push(parseInt(identifier,10));continue}l=!0;break}identifier=identifier.slice(1,-1)}if(!k&&!g.test(identifier)){l=!0;break}j.push(identifier.trim()),k=o[2]==="["}while(n);if(l===!0){e.warning(a,"Invalid object syntax"),this._skip=!0;return}this.order=j,this.olength=j.length,this.meta=!1,this.olength===1&&typeof j[0]=="string"&&typeof a._metaData!="undefined"&&typeof a._metaData[j[0]]!="undefined"&&(this.meta=!0,this.metaKey=j[0],this.needs=e.mergeObjectWith({},a._metaData[j[0]].needs)),q=e.stringOnly(this.order),q.stringOnly&&(this._stringOnly=!0,this.meta=!1,this.order=[new d(q.string)],this.olength=1,this.needs={})},g=f.reIdentifier=/[^\d\.\['"\s]{1}.*/;f.prototype.execute=function(a,b,c){if(!!this._stringOnly)return this.order[0].execute(a,b);try{return b.getObject(a,this.order,c)}catch(d){return b.debugMode&&b.error(a,"Was unable to get object "+this.modifies().join(".")),""}},f.prototype.set=function(a,b,c){if(!this.meta)try{c=typeof c.execute!="undefined"?c.execute(a,b):c,b.setObject(a,this.order,c)}catch(d){b.debugMode&&b.error(a,"Was unable to set object "+this.modifies().join("."))}else b.debugMode&&b.error(a,"Meta Data variable cannot be set at run time");return""},f.prototype.delete=function(a,b){if(!this.meta)try{b.deleteObject(a,this.order)}catch(c){b.debugMode&&b.error(a,"Was unable to delete object "+this.modifies().join("."))}else b.debugMode&&b.error(a,"Meta Data variable cannot be deleted at run time");return""},f.prototype.modifies=function(){if(typeof this._modifies!="undefined")return this._modifies;var a=this.order,b=0,c=a.length,d=[];while(b<c){if(typeof a[b]!="string"&&typeof a[b]!="number")break;d.push(a[b]),b++}return this._modifies=d,this._modifies},f.prototype.type="object"});if(typeof process!="undefined")var define=require.define;define("utilities",["require","exports","module","./string","./number","./object","./template","./template"],function(a,b,c){var d=a("./string").String,e=a("./number").Number,f=a("./object").Object,g=b.stringOnly=function(a){var b=a.length,c=!0,f="",g;while(b--){g=a[b];if(!(g instanceof d||!!g._stringOnly||g instanceof e)){c=!1;break}f=g.execute()+f}return{stringOnly:c,string:f}},h=b.warning=function(a,b){var c=i(a),d;if(typeof b=="string")a._warnings.push({warning:a.language.warning(b),lineNumber:c});else if(typeof b!="undefined"){d=b.length;while(d--)a._warnings.unshift({warning:a.language.warning(b),lineNumber:c})}},i=b.getLineCount=function(a){var b=a._leftCount,c=a._lineOffset,d=a._stringCache,e=-1,f=0,g=0;while(b>0)e=d.indexOf("<{",e+1),b--;while(e>f&&f>-1)f=d.indexOf("\n",f+1),g++;return(g>0?g:1)+c},j=b.mergeObjectWith=function(a,b){if(typeof a=="undefined"&&b==="undefined")return{};if(typeof a=="undefined")return b;if(typeof b=="undefined")return a;var c=Object.keys(b),d=c.length;while(d--)a[c[d]]=b[c[d]];return a},k=b.mergeWarnings=function(a,b){typeof b._warnings!="undefined"&&b._warnings.length!==0&&(typeof a._warnings=="undefined"&&(a._warnings=[]),a._warnings=a._warnings.concat(b._warnings.slice()),a._warnings.sort(function(a,b){return a.lineNumber-b.lineNumber}))},l=b.createSubTemplate=function(b,c,d){typeof _Template=="undefined"&&(_Template=a("./template").Template);var e=i(b),f=new _Template({rawString:c,lineOffset:e},b);return k(b,f),b._leftCount=b._leftCount+f._leftCount,typeof d!="undefined"&&(d.needs=j(d.needs,f.needs),d.sets=j(d.sets,f.sets),d.modifies=j(d.modifies,f.modifies),d.needsCallback=!!f.needsCallback),f},m=b.parseType=function(b,c){return typeof _Template=="undefined"&&(_Template=a("./template").Template),c=c.trim(),b instanceof _Template||h(b,"parseType expects its first argument to be a Noodles Template"),/^\-?\d+\.?\d*$/.test(c)?new e(b,c):/^('|")[^'"]+\1{1}$/.test(c)?new d(b,c.slice(1,-1)):f.reIdentifier.test(c)?new f(b,c):c},n=b.grabToEndSliceRaw=function(a,b,c){if(typeof a.endTags=="undefined")return"";var d=a._rawString,e=Object.keys(a.endTags),f=0,g=[],i=/<\{end(\s|\}){1}/i,j=e.length,k=1,l,m;while(j--)g.push(new RegExp("<\\{"+e[j]+"\\s{1}","i"));while(k>0){l=o(d,g,f),m=o(d,i,f);if(m>l&&l!==-1)k++,f=l+1,l=0;else if(m!==-1)k--,f=m+1;else if(k!==-1){c=c||"Tag",h(a,c+a.language.warning(" was improperly ended")),typeof b!="undefined"&&(b.skip=!0);break}}return f--,k=d.indexOf("}>",f),a._rawString=a._rawString.slice(k+2),d.slice(0,f)},o=b.searchByIndex=function(a,b,c){a=a.slice(c),typeof c=="undefined"&&(c=0);var d=-1,e,f;typeof b.length=="undefined"&&(b=[b]),e=b.length;while(e--)f=a.search(b[e]),f!==-1&&(f<d||d===-1)&&(d=f);return d===-1?-1:d+c}});if(typeof process!="undefined")var define=require.define;define("context",["require","exports","module","./template"],function(a,b,c){var d,e=b.Context=function(b,c,e){typeof d=="undefined"&&(d=a("./template").Template),this._others=c,this._metaData=b._metaData,this._metaSkip={},this.exitNow=!1,this.exitLoop=!1,e?(this.debugMode=!0,this.errors=[]):this.debugMode=!1};e.prototype.getObject=function(a,b,c){b=typeof b!="object"?[b]:b;var d=b[0].toLowerCase(),e,f,g;if(!this._metaSkip[d]&&this._metaData.hasOwnProperty(d))return this._metaData[d].execute(a,this);e=this._others;for(var h=0,i=b.length;h<i;h++){d=typeof b[h].execute!="undefined"?b[h].execute(a,this).toLowerCase():b[h];if(typeof e[d]!="undefined")e=e[d];else{f=","+Object.keys(e).join()+",",g=f.toLowerCase().indexOf(","+d+",");if(!(g>-1))return e[d]="","";d=f.slice(keyindex+1,keyindex+1+d.length),e[d.toLowerCase()]=e[d],e=e[d]}}return typeof e.execute!="undefined"?e.execute(a,this):typeof e=="object"&&!c?" ":e},e.prototype.setObject=function(a,b,c){b=typeof b!="object"?[b]:b;var d=this._others,e=b[0].toLowerCase(),d,f,g;!this._metaSkip[e]&&this._metaData.hasOwnProperty(e)&&this.debugMode&&this.error(a,"Meta Data variable cannot be set at run time");for(var h=0,i=b.length-1;h<i;h++){e=typeof b[h].execute!="undefined"?b[0].execute(a,this).toLowerCase():b[h];if(typeof d[e]!="undefined")d=d[e];else{f=","+Object.keys(d).join()+",",g=f.toLowerCase().indexOf(","+tmp+",");if(!(g>-1))return"";e=f.slice(keyindex+1,keyindex+1+e.length),d[e.toLowerCase()]=d[e],d=d[e]}}d[(typeof b[i].execute!="undefined"?b[i].execute(a,this):b[i]).toLowerCase()]=typeof c.execute!="undefined"?c.execute(a,this):c},e.prototype.deleteObject=function(a,b){b=typeof b!="object"?[b]:b;var c=this._others,d=b[0].toLowerCase(),c,e,f;this._metaData.hasOwnProperty(d)&&this.debugMode&&this.error(a,"Meta Data variable cannot be deleted at run time");for(var g=0,h=b.length-1;g<h;g++){d=typeof b[g].execute!="undefined"?b[g].execute(a,this).toLowerCase():b[g];if(typeof c[d]!="undefined")c=c[d];else{e=","+Object.keys(c).join()+",",f=e.toLowerCase().indexOf(","+tmp+",");if(!(f>-1))return"";d=e.slice(keyindex+1,keyindex+1+d.length),c[d.toLowerCase()]=c[d],c=c[d]}}delete c[(typeof b[h].execute!="undefined"?b[h].execute(a,this):b[h]).toLowerCase()]},e.prototype.error=function(a,b){var c=a._executionStack[e.current].lineStart;this.errors.push({error:a.language.error(b+"on line "+c+"."),lineNumber:c})}});if(typeof process!="undefined")var define=requirejs.define;define("template",["require","exports","module","./utilities","./string","./object","./context","./globalization"],function(a,b,c){var d=a("./utilities"),e=a("./string").String,f=a("./object").Object,g=a("./context").Context,h=a("./globalization"),i=typeof process=="undefined",j={},k=b.Template=function(a,b){this._rawString=a.rawString,this._stringCache=a.rawString,this._document=[],this._leftCount=0,this._warnings=[],this._metaData={},this._needs={},this._master=!1,this._tagDelegation={},this._lineOffset=a.lineOffset||0,this._executeOnce=!!a.executeOnce,a.metaKey&&(this._metaKey=a._metaKey);var c=a.metaData,d;typeof a.metaData!="undefined"?l.call(this,a):typeof b!="undefined"&&b instanceof k&&(this._plugins=b._plugins,this.language=b.language,u.call(this))},l=function(a){var b=this;this._id="master-"+Date.now(),a.language=typeof a.language!="undefined"?a.language:"english",h.language(a.language,function(c){m.call(b,a,c)})},m=function(a,b){this.language=b,this._plugins=this.language.coreTags.slice();var c=a.metaData,d=c.split(/\n+/),e=d.length,g=/([^=]+)(={1})(.*)/,h,i,j,l,m;if(c.length>0)while(e--){if(/^\s+$/.test(d[e]))continue;h=g.exec(d[e].trim()),i=h[1].toLowerCase().trim(),j=h[3].trim();if(f.reIdentifier.test(i)&&h[2]==="="){if(i===this.language.other("plugins")){this._plugins=this._plugins.concat(j.toLowerCase().split(","));continue}switch(i[0]){case"\\":this._metaData[i.slice(1)]=new k({rawString:j,executeOnce:!0,metaKey:i.slice(1)},this);break;case"#":break;default:this._metaData[i]=new k({rawString:j,executeOnce:!1},this)}}}this._master=!0,this.onFinishCompiling=a.onFinishCompiling,u.call(this)},n=function(){this._templating=!0;while(this._templating)o.call(this);this._master&&(this.onFinishCompiling(this),delete this.onFinishedCompiling)},o=function(){var a=this._rawString.indexOf("<{"),b=this._rawString.indexOf("}>"),c,f,g,h;if(a>-1){this._leftCount++;if(b>-1){c=this._rawString.slice(a+2,b),this._document.push(new e(this,this._rawString.slice(0,a))),this._rawString=this._rawString.slice(b+2);if(c.charAt(0)===" ")d.warning(this,"Invalid whitespace at the start of expression");else{f=c.split(" ")[0].toLowerCase(),g=d.getLineCount(this),h=f.split(".")[0],c=typeof j[this._tagDelegation[h]]!="undefined"?j[this._tagDelegation[h]].handleToken(this,c,f):d.parseType(this,c);if(typeof c.skip=="undefined"||c.skip===!1)c.lineStart=g,this._document.push(c),c.needs=c.needs||{}}}else this._rawString=this._rawString.slice(a+2),d.warning(this,"Open ended expression")}else this._rawString.length>0&&this._document.push(new e(this,this._rawString)),this._documentLength=this._document.length,delete this._rawString,f=d.stringOnly(this._document),f.stringOnly&&(this._stringOnly=!0,this._document=[new e(this,f.string)],this._documentLength=1,this.needs={}),this._templating=!1,p.call(this,this._master)},p=function(a){r.call(this,a),this._executionOrders=[],this._inAlready={};var b=this.callBackDocs.length,c,d;while(b--){if(this._inAlready[c.toString()])continue;this._executionOrders.unshift([]),c=this.callBackDocs[b],this._inAlready[c.toString()]=!0,q.call(this,c),this._executionOrders[0].push(c)}this._executionOrders.push([]),d=this._executionStack.length,b=0;while(b<d){if(this._inAlready[b.toString])continue;this._inAlready[b.toString()]=!0,q.call(this,b),this._executionOrders[0].push(b),b++}this._executionThreadLength=this._executionOrders.length},q=function(a){var b=this._executionStack[a],c=a+1,d,e,f;while(c--){if(this._inAlready[c.toString()])continue;d=this._executionStack[c];if(d.isAmbiguous){typeof d.needs!="undefined"&&Object.keys(d.needs).length!==0&&q.call(this,c),this._executionOrders[0].unshift(c),this._inAlready[c.toString()]=!0;continue}f=[],typeof d.modifies!="undefined"&&(f=f.concat(Object.keys(d.modifies))),typeof d.sets!="undefined"&&(f=f.concat(Object.keys(d.sets))),e=f.length;while(e--)if(typeof b.needs!="undefined"&&b.needs[f[e]]){typeof d.needs!="undefined"&&Object.keys(d.needs).length!==0&&q.call(this,c),this._executionOrders[0].unshift(c),this._inAlready[c.toString()]=!0;break}}return a},r=function(a){this.needs={},this.sets={},this.modifies={},this.callBackDocs=[];var b=this._document,c=b.length,d=0,f=[],g=-1,h,i,j,k,l,m;while(d<c){h=b[d];if(h.skip){d++;continue}if(h instanceof e&&h.string.length===0){d++;continue}g++,f.push(h),h.isAmbiguous?this.isAmbiguous=!0:h.needsCallback&&(this.needsCallback=!0,this.callBackDocs.push(g));if(typeof h.sets!="undefined"){j=Object.keys(h.sets),l=j.length;while(l--)m=j[l].toLowerCase(),typeof this.sets[m]=="undefined"?this.sets[m]=!0:delete h.sets[j[l]]}if(typeof h.needs!="undefined"){i=Object.keys(h.needs),l=i.length;while(l--)m=i[l].toLowerCase(),typeof this.sets[m]=="undefined"&&(this.needs[m]=!0)}if(typeof h.modifies!="undefined"){k=Object.keys(h.modifies),l=k.length;while(l--)m=k[l].toLowerCase(),this.modifies[m]=!0}d++}this._executionStack=f,this._executionLength=this._executionStack.length};k.prototype.execute=function(a,b,c,d){var e,f,h=Date.now(),i,l;if(a instanceof k)e=b;else{e=new g(this,a,!!d),e.time=h,e.onRender=typeof b.onRender=="undefined"||b.debugMode?!1:b.onRender,e.onRenderAll=typeof b.onRenderAll=="undefined"?!1:b.onRenderAll,e.onFinish=typeof b.onFinish=="undefined"?function(){}:b.onFinish,e.bufferMode=!!c,i=this._plugins,l=i.length;while(l--)j[i[l]].onTemplateExecute(e,this)}f={},f.collected=new Array(this._executionLength),f.status=new Array(this._executionLength),f.threads=new Array(this._executionThreadLength),f.startFrom=0;if(this._master)s.call(this,e,!0,f,!1);else{if(!this.needsCallback)return s.call(this,e,!0,f);s.call(this,e,!0,f,c)}};var s=function(a,b,c,d){var e=0,f=b?this._executionOrders:c.threads[e],g=f.length,h=!1,i=this,j=[],k=this._master&&a.bufferMode,l=!1;while(e<g&&!a.exitNow)c.threads[e]=f[e].reduce(function(b,e){if(h||a.exitNow)return b.concat(e);if(typeof c.status[e]=="undefined")return i._executionStack[e].needsCallback?(c.status[e]="executing",a.debugMode&&(a._current=e),i._executionStack[e].execute(i,a,function(b){c.collected[e]=b,c.status[e]="done",s.call(i,a,!1,c,d)}),h=!0,b):(a.debugMode&&(a._current=e),c.collected[e]=i._executionStack[e].execute(i,a),c.status[e]="done",b);if(c.status[e]==="executing")return h=!0,b;if(c.status[e]==="done")return b},[]),c.threads[e].length===0&&(c.threads.splice(e,1),g--),h=!1,e++;return t.call(this,a,c,d,j)},t=function(a,b,c,d){var e=this._master&&a.bufferMode,f,g;if(a.onRender&&this._master){f=b.startFrom,g=this._executionLength;while(f<g){if(typeof b.status[f]=="undefined")break;if(b.status[f]!=="done")break;d.push(b.collected[f]),f++}d=e&&this._master?new Buffer(d.join("")):d.join(""),this._master&&a.onRender(d,a),b.startFrom=f}if(b.threads.length===0||a.exitNow){d=e&&this._master?new Buffer(b.collected.join("")):b.collected.join("");if(this._master)a.onRenderAll&&a.onRenderAll(d,a),a.onFinish(Date.now()-a.time,a);else{if(typeof c!="function")return this._executeOnce&&(a._metaSkip[this._metaKey]=!0,a.setObject(this,this._metaKey,d)),d;c(d)}}},u=function(){var a=this._plugins.length,b=a,c=this,e,f,g,h;console.log();while(a--)e=this.language.plugin(this._plugins[a]),typeof j[e]!="undefined"?(h=j[e],i&&!h.browserFriendly&&d.warning(this,["The following plugin will not work for the browser: ",c.language.others(h.pluginName)]),typeof h.onTemplateCreate!="undefined"&&h.onTemplateCreate(this,function(){b--;if(typeof h.willHandle!="undefined"&&h.handleToken!=="undefined"){var a=h.willHandle(c),d=a.length;while(d--)c._tagDelegation[a[d]]=h.pluginName;b===0&&(b=-1,n.call(c))}})):v.call(this,e,function(){b--,b===0&&(b=-1,n.call(c))})},v=function(b,c,e){var f=e?"./../../noodles_plugins/"+b+"/"+b:"./../plugins/"+b+"/"+b,g=this;a([f],function(a){if(typeof a=="undefined"||typeof a.Plugin=="undefined"){if(e)throw b+" does not exist as a plugin.";return v.call(g,b,c,!0)}a=a.Plugin;if(typeof a.pluginName=="undefined")throw"The following plugin needs a plugin name: "+a.toString();i&&!a.browserFriendly&&d.warning(g,["The following plugin will not work for the browser: ",g.language.others(a.pluginName)]),typeof a.onTemplateCreate!="undefined"&&a.onTemplateCreate(g,function(){c(),j[a.pluginName]=a;if(typeof a.willHandle!="undefined"&&a.handleToken!=="undefined"){var b=a.willHandle(g),d=b.length;while(d--)g._tagDelegation[b[d]]=a.pluginName}})})}});if(typeof process!="undefined"){var define=require("requirejs");define.config({baseUrl:__dirname,nodeRequire:require})}define("noodles",["./template","./number","./string","./plugin","./utilities","./object","./context","./config"],function(a,b,c,d,e,f,g,h){if(typeof process=="undefined")return{Template:a.Template,Number:b.Number,String:c.String,Plugin:d.Plugin,Object:f.Object,Context:g.Context,Utilities:e,Config:h};exports.Template=a.Template,exports.Number=b.Number,exports.String=c.String,exports.Plugin=d.Plugin,exports.Object=f.Object,exports.Context=g.Context,exports.Utilities=e,exports.Config=h})